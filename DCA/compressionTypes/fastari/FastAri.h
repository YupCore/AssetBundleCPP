#pragma once
/*  FastAri 0.3 - A Fast Block-Based Bitwise Arithmetic Compressor
Copyright (C) 2013  David Catt

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program. If not, see http://www.gnu.org/licenses/
Modified by YupCore.
                                                                         

                                                                     AHRI :)
                                                .:
                                               .!7.
                                               ~^!!                                                      :^
                                              ~~:^?~                                                 .:~!7:
                                             :!:::~?^                                            .:^~!~~^:
                                             ~~::::!?.                                       .:^!!!~^:~~.
                                            :7^::::^?7.                                  .^~!!!!~^:::~~:
                                            ~!^^^^^^~?!                              .:~!!!!!!~^^^::~7:
                                            !~^^^^^^^!?!                          .^~!!!!!7!~^^^^^^~!:
                                           .!~^^^^^^^^!?!    ..:::::::::::..   :^!!!777!!!~!!~^^^^!!.
                                           :7^^^^~!~^^~7?7~!7777777???????77!~!?7777!~^:^~~~^^^^^7!.
                                           :7^^^^!~7~^^~77J?!77?????777777????7!~!!~^^~!77!!^^^~7~.
                                           :7^^^^!:~77!777!??7777!777777!!!!!!!!77777!~^^^!~^^!7!.
                                           :7^~~~7^^~!77??777!!~!7!!777777!!!!!!!7!77!!!!77~~!7777
                                           :?^!7!~~~!!7777777!!!!777!!7777!!7!!!777!!77!~^^^~~!?77.
                                        .^~!?~!!77!~?7!7777!!!!7!!777!!!!!7!!7!!!!77!!!777~^~!!7?7
                                       :7~77^.^^~!7?7!777!!!!!!!!!!777!~!!!!!!7!~~!!77!~!7~~!!!7~7^
                                       :!~7!~~^^~~7?!77!!!!!!!7!~!!!?77!~!!!!!!?!~!~!77!~!?7~^~77?7!~~:
                                    .:^~7?7~~7?!77??77!!!!!!!!7!!!!~!?7!~~~~!!!!?!~!!!77!~~~7JJ?7!!7~^.
                                 .:^~!!???7?7JJ!777!7!~!!!!!!!!!~~~~~!7!~~~~~~~~7?!!!!!77~^^~YJJ?7!~:
                                ^!!!!!7??~7?JJ??!^~7!^~~!~~~!!!~~~~~~~7!~~!~~~~~!?!~~~~!!!^~~!J777!7!:
                                ^!7!!!7?~~77??J7~~~7~^~~~^^^~!7~^~~^~~!7~^!~^~~^~?7~^^^~!!!~~~77!!~:.
                                  :~!7?7^!!!77?7!~!7~~!~^^^^^~?!:^~^^~~?~^!^^^^^^?7~~~~~!!7!!!!77.
                                    .^:!~7!!7777!!!!~!!~~~~~~!?J!~~~~~~7!~7~~~~~~??!~~~~~77!!!!!!^
                                      ~J?777777!!!!!~!7~~~~~!??!?!~~~~~7!77~~~~~7~^77!~~~!??!!!!!!^
                                    .!J?77?7!!?!!!~!!77~~~!!7?^:!?!~~!~!7?!~~~!!~..^?J?!!~!J?77!!!!~.
                                  .^!!777??!~!?!!!!!!7!!!!!7?^...~7!!7!!77~~~!7!^~^^:~???7!!777??777!~^..
                                :^^..!:!7J7~~!7!!!!!77!!!!!7^:::::^7?!7?J!~!!7~:^^~!777?7777777?Y!~!!~~^:
                             .^~^.  ~: !7?!~~!7!~~!77!~~!77~^~~~^^^^~!7Y?~7?~:^J5P5J!J!!Y!~!!7????:
                            :^^.  .~.  !7?~!!?7~~!7J!~~~77~~!7?JJ?!~:.^?7!~:.:?YJ?~~~7^!7?^^~~!?!~7:
                           ..    ^!.  .7?7~!7?~!!7J!~~!?7!J5?JY5Y?!^~::::^:..:^^~~~~~^^7~?~^^!777~^7^
                                ~7:   .77!!?7!!77?!!77!77:^!7!7777~:::....:::::::::^^~77!?~~!777!!~:~:
                               !7~    :?77??77???7J?7!^~?!^^^^~^^^::::::::::::::^^^^^~7??7!???7!!!!~.
                              ^?7.    ~J!777!!77!7Y!~~^^!!!~~~^^^^^:::::::::^^::::^^^!J7!!!J?!~~~7!^~:
                              .!7     !7~!7!^^~!!J7!!!~^^~7!!!!~^^::::::::::^^::::::^!J!!!!7J?~^^~7!^~~:
                                .     7!!7!~~!~!??~!?777!~~~!7!~^:::::::::::::::::::~???!!!7??7~~~!?!~!!!:
                                     ^7!7!!!!!~777!7~^~J?7!~~!~^::::::::::::^^^::::!?!!?!^~7?7??!!!??!!!!?!:
                                    .777!!7!!!?77?7~^^?77YY7~::::::::::^^^~~~^:::~?777~7!^!7?!7!7!!7Y7!!77?J~.
                                    ~??777!!7J!7?7~~~!?~!JYYYJ?!^:...::::::::::^!77!7?!77~777!?7~777Y7!!!77J77:
                                   ^J?777!!??~!?!~!~~?77!YJJJYY5YJ?!^::...::.:!?^^^^~~~!7!?7????!77?J7!!!!7!.?7.
                                 .~J?77!!!?!^!7!~~~^!?!??YJJJJJYYY555YJ?!~^^!JY7^^^^^^^^!!7!7!~?77?7?!7!!!?^:??.
                               .~?J?7!!!7?~:!7!!~^^^7?7?!7?JJYYYYYYYYY55555555J!^^^^^^^~!7!!7!~77?77??7!!77~77:
                             .~7?J7~~!!??~^!7!7!~~^~?J!^^^~!!7?JYYYYJYYYY5555J777^^^^^~7?7!~7!!7?~7JJ7!!7J7~:
                            ^!77!!~^~7J7!!!7!Y7!~!~!??~^^^^^^^~!7??JJYYYYYYYY?~7!^^^^^7?!!!~7777~^~?777?777. :~:
                          .!!77~!!~~7?7!7!?!J??!!!!7?!7~^^^^^^^^~~~!77?J?J?J??7?J!^^^7777777?7~^^^^!???7!!?J?JY!
                         :!77?!!!!7?7?!7?!?7?!77!!!7?!!7^:::^^::::::::^^!77J????7^:~77!!!77?!^^^^^^!J?77?YYYYJJ7
                        ::77?J7!7?J7??!7J7??~:^!7!!!?!~!7~::^7!:::::::::::^~!~~?7!!77!!!!!!7^^^:~^^~??YYYYYYYJJ!
                       ..:77??77??7!7J7!~^^?!^^^!77!77~^!7!^:^!~::::....:::::..:!!77~!!!!!7~::::~~^~YYYYYYYYJ?Y7::^^:
                       .:.~7777?J7!7!~::::::!7!^:^~77?7~~~!77!!7^^^:::........:!~:7^~!!!~!!:..:.:^~~YYYYYYYJ7JJJ~!?J!
                         .^??77??!7!:.::::::.^~!~~~~^~7????77??7~^:..........:~?::7~~!~^~!!:..:^:.:^7YYYY?7?JJYJ7JJJ:             ..:^^^:.
                         .??777J7!7:::::::::..........:!??777!!777!!!~^:.....:~7!~7!!!~~~!7~^^!!::~:.^?Y7~?JYJJ?????.               ..:^!!~^.
                         7?77!7?77!:::::::..............:~!!777!!77!~~!!!~^:..:~^:^!!7!!!!!777?!7~::::~!?YYJ?????7??!:                   ~777.
                        .J77!~!7??^:::::::................:^^~!!!!!77!~~!!~~~:..:..:^!77777777!~^:::^~!JY?7???7777??7!~:                  ~7?^
                        !J!!!~~!?J:::::::::::.................::::::^~7!~!!:?7.......:^!777?!~^!!~^^~7Y?77?7777777???7~!7^.               ^7!.
                       :7~!~~!^^!?~.:::::::::..................:......:?!!?!~^..::::::.::^~~~~~~^:^^7J!77!!!!!7777??77777?7!^..          .!!.
                       ~7~?!^~7!~!7::::::.::::.......:::.......:^^::::~??7!:..:::::^^^::...::::::~^7?!!!~~~!7777??77?7!!7?77?7!!~^:::::^~!^
                       .!??7?7!7?7?7:::::.::::.......:^~^^:::::^~7!!!7??7~::::::::::::^^^:::::::!!77!!!~~!!777!?77!!?77!~J7:^~!7777!~~~~:
                       .!7?JY??JJYY5!::.....:::^~!!77????JJJJ??JJJJJJJJ????77!!!~~^^^:::^~^::::~!7!!!~~~!!!!^.:7?7!!!~~~77?7!~~!!!!!!~^:.
    :                .^777JJ?YYYYYYY5!:^^~!7??JJYYJJ??77777777777!!!!!!!!!77777???JJJ?77!~!!^^~~7~7!!~~!!!^...:7?!~~~~!77!7JJJ?777777!!!7!!^:
    .~^.          .:~777?J?7JJJJJ???????JYJJJ??777!!!!!!!!!!!!~~~~~~~~~~~~~!!!!!!!777???JJJJ?7^7!!!!~~!!^....^~~^^^~~!7!!!77!7??7777?YJ7~^~~77!^.
      ^77!~^^^^^~!77?77??7!77??JYYYYJJJ??7777!!!!!!!~~~~~~~~~!!!!!!!!!!~~~~~!!!!!!!!!!!!7?JJY?7!!!!!~!~:...:~~^^^~~!!!~!!!77!!!7?77!!7J?7:   :!77~:
        :~!7777?????77??77?7!~!7J???777777777!!!!!~~!~~!!!!!!!!!!~~~^^:::::::::::^^~~~!!!!777!7!~!!!!^....^!^^~~!!!!!!!!!!!7!!!!!7?7!~!?7?!.   ~777~.
            :^~7??7!!?J7!JJ?????????777777777!!!!!!~!!777!7!~^:........................::^^~!77!~!!!:.:^^!77777!!!!!!!!!!!7?!!!!7!??7~:!?!77.  .?777?~
        .:^~!!777!!!7J?!!77???7????777777777777!!!!!!~~^::!^^::............................~!?7!~7!^~!!77JJ7!!!~!!!!!!!!!!7???7!777?77^~?!!7?. .77777J
      :~~~~^~777!!7!?J7!!7!!7??777777777777777!!~~^::.....^!^^:::.......................:::77J7!?!!?7!~~^~??77777!!!!!!777!777??777?77!!?7!!7? ^7!7777
   .~!!~^^:!?7!!!!7?7?7!!!!777??777777777?!!~~^^::.......::~~^::::::::...........:::^^~~~~~!!!!!!!??J?7~~~!??7~~!?7777777777??!7???J77!!?!~!!??7!!77?7
 .~77!!!^.7?7!!!~~!7?J77!!7??7!7???J7?77?J^::^::::::::^:::::~~:::::::::::::::^^~~~~~~^^^^^^^^~!!7??7??J!.:~~!77^~7?7777777777?J7!77J7!!?J!^~~7J!!7??^!
 77!!!?^ ^?777?!^!77?J?7!!7??7!!!!?!~7!!?7:::^^::::::.::::^^^~~^:::::::::^~!~~~~~~~~~^^^^~~!7?77777!!~~7!~~!7??!7?777777777???????7?!!77J!~^!?!!!?7..7
 ~77!7J7 ~?7!7J7~!!77???!!77??!!77~!?~!!77!^::^~^::::..........^^^^::::::^7???77!!!!~~~!!!!!!!!!777!!^^!!!!7J?~^^~7?77777777????7?77!7!7?!!7?7777^.:7~
  :!77J?!~J7!!~?777!7?!J?!77!7777!??~!77!77?7^^^^::^^^^::::::::::^^7?!~^^::^!7?7??777!!777!!!!!!77777!7?J7~~!JJ!~!7?YYJJ?777!!7?7!?!~~!7!!777!^77 ..
    :~77777777!77!!7?J77J?77!7????7!77?77?7JJ~~^^^^...:::::.:::^^^^^75P5YJJ??JYJ77777!777!!!7777777777Y5J~~~~J5YJ?YYYYYYJ??77??J??7!7?????7??. !!

*/

#include <stdlib.h>
#include <memory>
#define ORDER 17
#define ADAPT 4
const int mask = (1 << ORDER) - 1;
class FastAri
{
public:
	static int fa_compress(const unsigned char* ibuf, unsigned char* obuf, size_t ilen, size_t* olen);
	static int fa_decompress(const unsigned char* ibuf, unsigned char* obuf, size_t ilen, size_t olen);
};